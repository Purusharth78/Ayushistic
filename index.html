<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>For Ayushi ‚ù§Ô∏è</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&family=Fredoka:wght@500&family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
    <style>
        /* --- THEME --- */
        :root { --primary: #ff3366; --bg: #120508; --glass: rgba(255, 255, 255, 0.1); }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; padding: 0; font-family: 'Poppins', sans-serif; background: var(--bg); color: white; height: 100vh; overflow: hidden; display: flex; justify-content: center; align-items: center; user-select: none; }
        
        .stars { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: radial-gradient(circle at center, #2e0c15 0%, #000 100%); z-index: -2; }
        
        /* --- TOAST --- */
        #toast-box {
            position: fixed; top: -100px; left: 50%; transform: translateX(-50%);
            background: white; color: var(--primary); padding: 12px 30px;
            border-radius: 50px; font-weight: 700; font-size: 1rem; z-index: 100000; 
            transition: 0.5s; display: flex; align-items: center; gap: 10px; border: 3px solid var(--primary);
        }
        #toast-box.show { top: 30px; }

        /* --- CREATOR MODE --- */
        #creator-app {
            background: white; color: #333; padding: 25px; border-radius: 25px;
            width: 90%; max-width: 400px; box-shadow: 0 0 50px rgba(255, 51, 102, 0.4);
            z-index: 2000; position: absolute; max-height: 90vh; overflow-y: auto; text-align: center;
        }
        .input-group label { display: block; text-align: left; font-weight: bold; margin-bottom: 5px; }
        .input-group input { width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 10px; outline: none; }
        .upload-area { border: 2px dashed var(--primary); background: #fff0f5; padding: 20px; border-radius: 12px; cursor: pointer; color: var(--primary); font-weight: 600; }
        .gen-btn { background: var(--primary); color: white; border: none; width: 100%; padding: 15px; border-radius: 50px; font-weight: 700; cursor: pointer; margin-top: 10px; }
        #share-panel { display: none; margin-top: 20px; }
        .link-box { background: #f4f4f4; padding: 12px; border-radius: 8px; font-size: 0.8rem; color: #444; overflow-x: auto; white-space: nowrap; }

        /* --- VIEWER MODE --- */
        #viewer-app { display: none; width: 100%; height: 100%; position: relative; }
        .screen { display: none; width: 100%; height: 100%; flex-direction: column; align-items: center; justify-content: center; position: absolute; top: 0; left: 0; animation: fadeUp 0.6s ease; padding: 20px; text-align: center; }
        .active { display: flex; }
        @keyframes fadeUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* --- INTRO (HOLD) --- */
        #intro-title { font-family: 'Fredoka', sans-serif; font-size: 2.5rem; text-shadow: 0 0 20px var(--primary); margin-bottom: 30px; line-height: 1.2; }
        .hold-btn { 
            position: relative; width: 260px; height: 75px; 
            background: rgba(0,0,0,0.3); border: 2px solid #ff3366; border-radius: 50px; 
            display: flex; align-items: center; justify-content: center; 
            font-weight: 800; font-size: 1.2rem; cursor: pointer; overflow: hidden; 
            box-shadow: 0 0 30px rgba(255, 51, 102, 0.4); user-select: none;
        }
        .hold-fill { position: absolute; top: 0; left: 0; height: 100%; width: 0%; background: var(--primary); z-index: 0; transition: width 0.1s linear; }
        .hold-text { position: relative; z-index: 1; pointer-events: none; letter-spacing: 1px; }

        /* --- BUTTONS --- */
        .btn-opt { background: var(--glass); border: 2px solid rgba(255,255,255,0.3); padding: 15px; width: 100%; margin: 8px 0; border-radius: 15px; cursor: pointer; transition: 0.2s; font-weight: 600; font-size: 1rem; display: flex; justify-content: space-between; align-items: center; }
        .main-btn { background: white; color: var(--primary); padding: 12px 35px; border-radius: 50px; border: none; font-weight: 800; font-size: 1.1rem; cursor: pointer; margin-top: 20px; box-shadow: 0 0 20px rgba(255,255,255,0.3); animation: pulse 2s infinite; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }

        /* --- GAME 1: MEMORY --- */
        .memory-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-top: 20px; width: 100%; max-width: 350px; perspective: 1000px; }
        .mem-card { width: 100%; height: 75px; position: relative; transform-style: preserve-3d; transition: transform 0.5s; cursor: pointer; }
        .mem-card.flipped { transform: rotateY(180deg); }
        .mem-card.matched .back { background: #4cd964; border: 3px solid white; box-shadow: 0 0 20px #4cd964; }
        .front, .back { width: 100%; height: 100%; position: absolute; backface-visibility: hidden; border-radius: 10px; display: flex; justify-content: center; align-items: center; box-shadow: 0 5px 10px rgba(0,0,0,0.3); }
        .front { background: var(--primary); color: white; font-size: 1.5rem; } 
        .back { background: white; transform: rotateY(180deg); font-size: 2.2rem; }

        /* --- GAME 2: RING HUNT --- */
        .garden-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-top: 20px; width: 100%; max-width: 350px; perspective: 1000px; }
        .gift-box-game { 
            width: 80px; height: 80px; background: rgba(255,255,255,0.1); border-radius: 20px; display: flex; justify-content: center; align-items: center; font-size: 3rem; cursor: pointer; border: 2px solid rgba(255,255,255,0.2); 
            transition: all 0.3s; 
        }
        .gift-box-game.found { background: #fff; border: 4px solid gold; box-shadow: 0 0 40px gold; animation: pulse 1s infinite; }
        .gift-box-game.shake { animation: shakeAnim 0.4s; background: rgba(255,0,0,0.2); border-color: red; }
        @keyframes shakeAnim { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } }

        /* --- GAME 3: BALLOONS --- */
        #balloon-zone { width: 100%; height: 100%; position: fixed; top: 0; left: 0; z-index: 99999; overflow: hidden; pointer-events: none; }
        .balloon { 
            position: absolute; bottom: -150px; width: 90px; height: 110px; 
            background: linear-gradient(135deg, #ff5e62, #ff9966);
            border-radius: 80% 80% 80% 80% / 80% 80% 120% 120%; 
            cursor: pointer; display: flex; justify-content: center; align-items: center; 
            font-size: 0; box-shadow: inset -10px -10px 20px rgba(0,0,0,0.2); 
            pointer-events: auto; animation: flyUp 5s linear forwards; border: 2px solid rgba(255,255,255,0.2);
        }
        .balloon::after { content: ''; position: absolute; bottom: -60px; left: 50%; width: 2px; height: 60px; background: rgba(255,255,255,0.5); }
        @keyframes flyUp { 0% { bottom: -150px; } 100% { bottom: 120vh; } }
        .pop-result { position: absolute; font-size: 4rem; font-weight: bold; z-index: 100000; animation: popUp 0.5s forwards; text-shadow: 0 0 20px black; }
        @keyframes popUp { 0% { transform: scale(0); opacity: 0; } 50% { transform: scale(1.5); opacity: 1; } 100% { transform: scale(1); opacity: 0; } }
        .progress-cont { position: absolute; top: 20px; left: 20px; background: rgba(255,255,255,0.2); border-radius: 12px; padding: 8px 15px; z-index: 100000; font-weight: bold; border: 1px solid rgba(255,255,255,0.3); }

        /* --- REASONS --- */
        .reasons-list { width: 100%; max-width: 350px; text-align: left; }
        .reason-item { background: white; color: #333; margin-bottom: 10px; padding: 15px; border-radius: 12px; display: flex; align-items: center; gap: 15px; font-size: 0.9rem; font-weight: 600; box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
        .r-num { background: var(--primary); color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; justify-content: center; align-items: center; font-weight: bold; flex-shrink: 0; }

        /* --- S9: PHOTO STACK --- */
        .stack-container { position: relative; width: 300px; height: 400px; margin-top: 20px; }
        .stack-card { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: white; padding: 10px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); transition: transform 0.5s ease, opacity 0.5s; cursor: pointer; display: flex; flex-direction: column; align-items: center; }
        .stack-card img { width: 100%; height: 320px; object-fit: cover; border-radius: 10px; }
        .stack-caption { color: #333; font-family: 'Dancing Script'; font-size: 1.5rem; margin-top: 10px; }
        .stack-card.fly-out { transform: translate(200px, -200px) rotate(45deg); opacity: 0; pointer-events: none; }

        /* --- PROPOSAL --- */
        .wax-envelope { width: 280px; height: 180px; background: #ff4d6d; border-radius: 10px; position: relative; display: flex; justify-content: center; align-items: center; box-shadow: 0 10px 40px rgba(255, 51, 102, 0.4); transition: 0.5s; cursor: pointer; }
        .wax-seal { width: 80px; height: 80px; background: #d90429; border-radius: 50%; display: flex; justify-content: center; align-items: center; font-size: 2.5rem; box-shadow: 0 5px 15px rgba(0,0,0,0.3); border: 2px dashed rgba(255,255,255,0.3); animation: pulse 2s infinite; }
        .wax-envelope.open { transform: translateY(200px) scale(0); opacity: 0; }
        .letter-content { display: none; background: white; color: #333; padding: 25px; border-radius: 15px; width: 90%; transform: rotate(-2deg); box-shadow: 0 0 50px rgba(255,255,255,0.5); font-family: 'Dancing Script'; font-size: 1.5rem; text-align: center; }

        /* --- SUCCESS --- */
        .cute-gif { width: 100%; max-width: 320px; height: auto; border-radius: 15px; border: 4px solid white; box-shadow: 0 0 40px rgba(255,51,102,0.6); margin-bottom: 20px; display: block; margin: 0 auto; }
        .music-fab { position: fixed; top: 20px; right: 20px; width: 45px; height: 45px; background: rgba(255,255,255,0.2); border-radius: 50%; display: flex; justify-content: center; align-items: center; border: 1px solid white; cursor: pointer; z-index: 200; backdrop-filter: blur(5px); }
    </style>
</head>
<body>

    <div class="stars"></div>
    <div id="toast-box"><span style="font-size:1.5rem;">üôà</span><span id="toast-msg">Msg</span></div>

    <div id="creator-app">
        <h1 class="c-title">Love Creator üõ†Ô∏è</h1>
        <div class="input-group"><label>Her Name</label><input type="text" id="inp-name" placeholder="e.g. Anjali"></div>
        <div class="input-group"><label>Upload 6 Photos</label><div class="upload-area" onclick="document.getElementById('inp-files').click()">üìÇ Select Photos</div><input type="file" id="inp-files" multiple accept="image/*" style="display:none" onchange="updateFileCount()"><div id="file-status" style="font-size:0.8rem; color:#888; margin-top:5px;"></div></div>
        <button class="gen-btn" onclick="startUpload()">Generate Link üîó</button>
        <div id="load-bar" style="height:5px; width:0%; background:#ff4d6d; margin-top:10px; transition:0.3s; border-radius:5px;"></div>
        <div id="share-panel"><p style="margin-bottom:5px; font-weight:600;">Link Ready:</p><div id="final-link" class="link-box">...</div><button class="gen-btn" style="background:#25D366; margin-top:15px;" onclick="shareWA()">WhatsApp Share üíö</button><button class="gen-btn" style="background:#333; font-size:1rem; padding:12px;" onclick="preview()">Preview Gift</button></div>
    </div>

    <div id="viewer-app">
        <audio id="bg-music" loop><source src="https://files.catbox.moe/ss111o.mp3" type="audio/mp3"></audio>
        <div class="music-fab" onclick="toggleAudio()">üéµ</div>

        <div id="s1" class="screen active">
            <h1 id="intro-title">Hey <span id="disp-name">You</span>...</h1>
            <h2 style="font-size:1.1rem; opacity:0.8; margin-bottom:30px;">I have a question for you.<br>(Fir bolegi jab dekho game gameüòÇ)</h2>
            <div class="hold-btn" onmousedown="startHold()" onmouseup="stopHold()" ontouchstart="startHold()" ontouchend="stopHold()">
                <div class="hold-fill" id="h-fill"></div>
                <div class="hold-text">Hold this for 3 Seconds ‚è≥</div>
            </div>
        </div>

        <div id="s2" class="screen"><h1 style="font-size:2rem;">Truth Test üßê</h1><h2>Who started this chaos?</h2><div class="btn-opt" onclick="toast('Oh really? üòú')">Purusharth <span>üíÅ‚Äç‚ôÇÔ∏è</span></div><div class="btn-opt" onclick="next('s2','s3')">Ayushistic the cutest <span>üë∏</span></div><div class="btn-opt" onclick="toast('Okay... maybe both!, But try again üòÇ')">Both <span>üíë</span></div></div>
        <div id="s3" class="screen"><h1 style="font-size:2rem;">Truth Test üçï</h1><h2>What makes me happiest?</h2><div class="btn-opt" onclick="toast('Sleep is good, but no! üò¥')">Sleep <span>üõå</span></div><div class="btn-opt" onclick="next('s3','s4')">Seeing You <span>üòç</span></div><div class="btn-opt" onclick="toast('I wish! üí∏')">Money <span>üí∞</span></div></div>
        <div id="s4" class="screen"><h1 style="font-size:2rem;">Final Truth ü•∫</h1><h2>Can I keep you forever?</h2><div class="btn-opt" onclick="toast('Lagta hai apko zindagi se pyaar nhi hai üî™')">Maybe...MaybeNot <span>üëâüëà</span></div><div class="btn-opt" onclick="toast('BC mukka maar dunga üò§')">No <span>‚ùå</span></div><div class="btn-opt" onclick="next('s4','s_ask')">Yes, Please! <span>üíç</span></div></div>

        <div id="s_ask" class="screen">
            <h2 id="pre-game-txt" style="font-size:1.5rem; margin-bottom:30px; line-height:1.5;">Dekha I never forced you to choose, You yourself made the right choices üåπüòÇ<br>Thode or games khelein ?</h2>
            <div style="display:flex; gap:15px; justify-content:center; width:100%;">
                <button class="main-btn" onclick="next('s_ask','s5')" style="margin-top:0; background:#25D366;">Ji Haan! ‚ù§Ô∏è</button>
                <button class="main-btn" id="pre-no-btn" onclick="handlePreGameNo()" style="margin-top:0; background:transparent; border:2px solid white;">Nahi üôà</button>
            </div>
        </div>

        <div id="s5" class="screen">
            <h1 style="font-size:2rem;">Match Love üß©</h1>
            <h2>Find 4 Pairs to Proceed!</h2>
            <div class="memory-grid" id="mem-grid"></div>
        </div>

        <div id="s6" class="screen">
            <h1 style="font-size:2rem;">Find 3 Rings üíç</h1>
            <h2>Tap the boxes! (Wrong box = üôà)</h2>
            <div class="garden-grid" id="garden"></div>
            <h2 id="ring-status" style="margin-top:20px;">Found: 0/3</h2>
        </div>

        <div id="s7" class="screen"><h1 style="font-size:2rem;">Catch Love ‚ù§Ô∏è</h1><div class="progress-cont">Hearts: <span id="h-count">0</span>/5</div><h2>Pop Balloons!<br>(Watch out for empty ones!)</h2><div id="balloon-zone"></div></div>

        <div id="s8" class="screen">
            <h1 style="font-family:'Dancing Script'; font-size:3rem; margin-bottom:20px;">Why I Love You</h1>
            <div class="reasons-list">
                <div class="reason-item"><div class="r-num">1</div>Watching you smile brightens my day.</div>
                <div class="reason-item"><div class="r-num">2</div>I love your office bitchin sessions.</div>
                <div class="reason-item"><div class="r-num">3</div>You have a very cute accent.</div>
                <div class="reason-item"><div class="r-num">4</div>Turmeric milk peete rehti hai....surrr surrr</div>
                <div class="reason-item"><div class="r-num">5</div>You are my safe space.</div>
                <div class="reason-item"><div class="r-num">6</div>I just love everything about you!</div>
            </div>
            <button class="main-btn" onclick="next('s8','s9')" style="margin-top:30px;">A little surprise ‚ûú</button>
        </div>

        <div id="s9" class="screen">
            <h1 style="font-family:'Dancing Script'; font-size:3rem; color:#ff99ac;">Our Memories üì∏</h1>
            <div class="stack-container" id="gallery-box"></div>
            <p style="opacity:0.7; margin-top:10px;">(Tap photo to see next)</p>
            <button class="main-btn" onclick="next('s9','s10')">One Last Thing ‚ûú</button>
        </div>

        <div id="s10" class="screen"><div id="env" class="wax-envelope" onclick="breakSeal()"><div class="wax-seal" id="seal">‚ù§Ô∏è</div></div><p id="seal-txt" style="margin-top:20px;">Tap the Wax Seal to Open</p><div id="letter" class="letter-content"><h1 style="font-family:'Dancing Script'; font-size:2.8rem; line-height:1;">Will You Be<br>My Valentine?</h1><p>I promise to annoy you and love you forever.<br>(Ab mat bolna "aise kon puchta hai acche se puch üòÇ")</p><div style="display:flex; gap:15px; margin-top:20px; justify-content:center;"><button class="main-btn" onclick="celebrate()">YES! ‚ù§Ô∏è</button><button class="main-btn" id="no-btn" style="background:transparent; border:2px solid #ccc; color:#555; box-shadow:none;" onmouseover="runAway()">No</button></div></div></div>

        <div id="s11" class="screen">
            <img src="https://media.giphy.com/media/26BRv0ThflsHCqDrG/giphy.gif" class="cute-gif">
            <h1 style="font-size:2.5rem;">I really really Love You ‚ù§Ô∏è</h1>
            <p style="font-size:2.0rem; margin-top:10px;">I Knew You Would Say Yes üòé</p>
            <div style="font-family:'Dancing Script'; font-size:1.5rem; margin-top:10px;"> - Purusharth Sharma</div>
        </div>
    </div>

    <script>
        // --- üü¢ CLOUDINARY CONFIG üü¢ ---
        const CLOUD_NAME = 'dltes6xeo'; 
        const UPLOAD_PRESET = 'mhyvu22u'; 
        // -------------------------------

        function updateFileCount() { document.getElementById('file-status').innerText = document.getElementById('inp-files').files.length + " photos selected"; }
        function toast(t) { const b=document.getElementById('toast-box'); b.innerHTML=`<span>üîí</span> ${t}`; b.className='show'; setTimeout(()=>b.className='', 2000); }

        async function startUpload() {
            const n=document.getElementById('inp-name').value; const f=document.getElementById('inp-files').files;
            if(!n) return toast("Enter name!"); if(f.length<6) return toast("Select 6 photos!");
            document.getElementById('load-bar').style.width='100%';

            const uploads = Array.from(f).map(file => { 
                const fd = new FormData(); fd.append("file", file); fd.append("upload_preset", UPLOAD_PRESET); 
                return fetch(`https://api.cloudinary.com/v1_1/${CLOUD_NAME}/image/upload`, {method:"POST", body:fd}).then(r=>r.json()).then(d=>d.secure_url?{success:true,url:d.secure_url}:{success:false}).catch(()=>({success:false}));
            });

            try { 
                const res = await Promise.all(uploads); 
                if(res.filter(r=>r.success).length < 6) return toast("Upload failed. Try again.");
                
                let p = `?name=${encodeURIComponent(n)}`; 
                res.forEach((r,i) => { if(r.success) p += `&p${i}=${encodeURIComponent(r.url)}`; }); 
                let longUrl = window.location.href.split('?')[0] + p;
                
                // --- NO TINYURL (DIRECT LINK) ---
                document.getElementById('final-link').innerHTML = `
                    <span style="color:#ff3366;font-size:0.9rem;">‚ú® Link Ready:</span><br>
                    <a href="${longUrl}" target="_blank" style="color:#333;text-decoration:underline; word-break: break-all;">Click Here to Open Gift</a>
                `;
                document.getElementById('share-panel').style.display='block'; 
                document.getElementById('load-bar').style.width='0%';
                
            } catch(e) { toast("Error"); }
        }

        function shareWA() { 
            let txt = document.getElementById('final-link').innerText;
            if(document.getElementById('final-link').querySelector('a')) txt = document.getElementById('final-link').querySelector('a').href;
            window.open(`https://wa.me/?text=${encodeURIComponent("For Ayushistic ‚ù§Ô∏è: " + txt)}`); 
        }
        function preview() { 
            let txt = document.getElementById('final-link').innerText;
            if(document.getElementById('final-link').querySelector('a')) txt = document.getElementById('final-link').querySelector('a').href;
            window.location.href = txt; 
        }

        const params = new URLSearchParams(window.location.search);
        const name = params.get('name');
        if(name) {
            document.getElementById('creator-app').style.display = 'none'; document.getElementById('viewer-app').style.display = 'flex'; document.getElementById('disp-name').innerText = name;
            
            // --- AUDIO AUTOPLAY ATTEMPT ---
            const audio = document.getElementById('bg-music');
            audio.play().catch(e => { console.log("Audio waiting for interaction"); });
            document.body.addEventListener('click', () => { audio.play(); }, { once: true }); // Backup play on click

            const box = document.getElementById('gallery-box');
            let photos = []; for(let i=0; i<6; i++) { if(params.get('p'+i)) photos.push(params.get('p'+i)); }
            if(photos.length===0) { for(let k=0;k<6;k++) photos.push("https://images.unsplash.com/photo-1518199266791-5375a83190b7?w=500"); }
            
            photos.reverse().forEach((url, i) => { 
                const div = document.createElement('div'); div.className='stack-card'; div.style.zIndex = i;
                div.style.transform = `rotate(${Math.random()*10 - 5}deg)`;
                div.innerHTML=`<img src="${url}"><div class="stack-caption">Wear Different jacket next time üòÇ</div>`; 
                div.onclick = () => { div.classList.add('fly-out'); setTimeout(()=> { div.style.zIndex = -100; div.classList.remove('fly-out'); div.style.transform=`rotate(${Math.random()*10 - 5}deg) scale(0.9)`; }, 500); };
                box.appendChild(div); 
            });
        } else { document.getElementById('creator-app').style.display = 'block'; }

        function next(h,s) { document.getElementById(h).classList.remove('active'); document.getElementById(s).classList.add('active'); if(s==='s5') initMem(); if(s==='s6') initHunt(); if(s==='s7') initBal(); }
        function toggleAudio() { const m=document.getElementById('bg-music'); m.paused?m.play():m.pause(); }

        let holdTimer;
        function startHold() { document.getElementById('bg-music').play().catch(()=>{}); document.getElementById('h-fill').style.width = '100%'; document.getElementById('h-fill').style.transition = 'width 3s linear'; holdTimer = setTimeout(() => { confetti(); next('s1','s2'); }, 3000); }
        function stopHold() { clearTimeout(holdTimer); document.getElementById('h-fill').style.width = '0%'; document.getElementById('h-fill').style.transition = 'width 0.2s'; }

        // Ask Logic
        let noCount = 0;
        const noTexts = ["Khel le na ü•∫", "Arre badiya game hai üåπ", "Isme you can win, unlike othello on that date! üëâüëà", "Maan jao na üíî", "Ab toh Haan bolna hi padega! üôà"];
        function handlePreGameNo() {
            noCount++;
            if(noCount < noTexts.length) { document.getElementById('pre-game-txt').innerText = noTexts[noCount-1]; } 
            else { document.getElementById('pre-no-btn').style.display = 'none'; document.getElementById('pre-game-txt').innerText = "Ab toh Haan bolna hi padega! ‚ù§Ô∏è"; }
        }

        // Memory
        function initMem() {
            const grid = document.getElementById('mem-grid');
            const items = ['üêß','üêß','üåª','üåª','üòò','üòò','üç´','üç´']; items.sort(() => Math.random() - 0.5);
            let selected = []; let matched = 0;
            items.forEach((item) => {
                const card = document.createElement('div'); card.className = 'mem-card';
                card.innerHTML = `<div class="front">?</div><div class="back">${item}</div>`;
                card.onclick = () => {
                    if(selected.length < 2 && !card.classList.contains('flipped') && !card.classList.contains('matched')) {
                        card.classList.add('flipped'); selected.push(card);
                        if(selected.length === 2) {
                            if(selected[0].innerHTML === selected[1].innerHTML) {
                                setTimeout(() => { selected.forEach(c => c.classList.add('matched')); selected = []; matched++; if(matched === 4) { toast("Perfect! üéâ"); setTimeout(()=>next('s5','s6'), 1000); } }, 500);
                            } else { setTimeout(() => { selected.forEach(c => c.classList.remove('flipped')); selected = []; }, 800); }
                        }
                    }
                }; grid.appendChild(card);
            });
        }

        // Hunt
        let ringsFound = 0;
        function initHunt() {
            const g = document.getElementById('garden'); g.innerHTML=''; 
            let hidden = new Set(); while(hidden.size < 3) hidden.add(Math.floor(Math.random()*9));
            for(let i=0;i<9;i++) {
                const b = document.createElement('div'); b.className='gift-box-game'; b.innerText = 'üéÅ';
                b.onclick = () => {
                    if(!b.classList.contains('found')) {
                        if(hidden.has(i)) {
                            b.innerText = '‚ù§Ô∏è'; b.classList.add('found'); 
                            ringsFound++; document.getElementById('ring-status').innerText = `Found: ${ringsFound}/3`;
                            confetti({particleCount:30, spread:50}); if(ringsFound === 3) setTimeout(()=>next('s6','s7'), 1500);
                        } else {
                            b.innerText = 'üôà'; b.classList.add('shake'); toast("Nope! üôà"); setTimeout(()=> { b.innerText='üéÅ'; b.classList.remove('shake'); }, 800);
                        }
                    }
                }; g.appendChild(b);
            }
        }

        // Balloons
        let heartsFound = 0;
        function initBal() {
            const zone = document.getElementById('balloon-zone');
            const iv = setInterval(()=>{
                const b = document.createElement('div'); b.className='balloon';
                b.style.left = Math.random()*80 + 10 + '%';
                b.style.background = `radial-gradient(circle at 30% 30%, #ff5e62, #ff9966)`;
                const isH = Math.random()>0.4;
                b.onclick = (e) => {
                    const res = document.createElement('div'); res.className = 'pop-result';
                    res.style.color = isH ? '#ff0000' : '#888'; res.innerText = isH ? "‚ù§Ô∏è" : "üí®";
                    res.style.left = e.clientX + 'px'; res.style.top = e.clientY + 'px';
                    document.body.appendChild(res); setTimeout(()=>res.remove(), 1000); b.remove();
                    if(isH) { heartsFound++; document.getElementById('h-count').innerText=heartsFound; if(heartsFound===5) { clearInterval(iv); setTimeout(()=>next('s7','s8'), 1000); } }
                }; zone.appendChild(b); setTimeout(()=>b.remove(), 6000);
            }, 500);
        }

        function breakSeal() { document.getElementById('seal').style.transform = 'scale(1.5)'; document.getElementById('seal').style.opacity = '0'; setTimeout(() => { document.getElementById('env').classList.add('open'); document.getElementById('seal-txt').style.display = 'none'; setTimeout(() => { document.getElementById('env').style.display='none'; document.getElementById('letter').style.display='block'; }, 500); }, 500); }
        function runAway() { const b=document.getElementById('no-btn'); b.style.position='absolute'; b.style.left=Math.random()*70+'%'; b.style.top=Math.random()*70+'%'; }
        function celebrate() { next('s10','s11'); confetti({particleCount: 200, spread: 100}); }

        
    </script>
</body>
</html>
